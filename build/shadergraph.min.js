!function t(n,e,r){function i(u,a){if(!e[u]){if(!n[u]){var s="function"==typeof require&&require;if(!a&&s)return s(u,!0);if(o)return o(u,!0);throw new Error("Cannot find module '"+u+"'")}var c=e[u]={exports:{}};n[u][0].call(c.exports,function(t){var e=n[u][1][t];return i(e?e:t)},c,c.exports,t,n,e,r)}return e[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(t,n){var e,r,i;r=t("./graph"),i=function(){function t(t,n){this.start=null!=t?t:[],this.end=null!=n?n:[]}return t}(),e=function(){function t(t){this.library=t,this.end()}return t.prototype.snippet=function(t,n){var e,r;return r=this.library.fetch(t),e=r.apply(n),this},t.prototype.append=function(t){var n,e,r,i;for(this.graph.add(t),i=this._state.end,e=0,r=i.length;r>e;e++)n=i[e],n.connect(t);return this._state.start.length||(this._state.start=[t]),this._state.end=[t],this},t.prototype.prepend=function(t){var n,e,r,i;for(this.graph.add(t),i=this._state.start,e=0,r=i.length;r>e;e++)n=i[e],t.connect(n);return this._state.end.length||(this._state.end=[t]),this._state.start=[t],this},t.prototype.group=function(){return this._push(),this._push()},t.prototype.pass=function(){return this.next(),this._state.start.push(null),this.combine()},t.prototype.next=function(){var t;return t=this._pop(),this._state.start=this._state.start.concat(t.start),this._state.end=this._state.end.concat(t.end),this._push()},t.prototype.combine=function(){var t,n,e,r,i,o,u,a,s,c;if(this._stack.length<=2)throw"Popping factory stack too far";if(this.next()._pop(),e=this._pop(),n=this._state,e.start.length)for(s=e.start,i=0,u=s.length;u>i;i++)if(r=s[i])for(c=n.end,o=0,a=c.length;a>o;o++)t=c[o],t.connect(r,!0);else e.end=e.end.concat(n.end);return n.end=e.end,this},t.prototype.end=function(){var t;return t=this.graph,this.graph=new r.Graph,this._state=new i,this._stack=[this._state],this.group(),t&&(t.compile=function(){return t.tail().owner().compile()}),t},t.prototype._push=function(){return this._stack.unshift(new i),this._state=this._stack[0],this},t.prototype._pop=function(){return this._state=this._stack[1],this._stack.shift,this},t}(),n.exports=e},{"./graph":3}],2:[function(t,n){var e;e=function(){function t(t,n){this.parent=null!=n?n:null,this.nodes=[],t&&this.add(t)}return t.IN=0,t.OUT=1,t.prototype.inputs=function(){var t,n,e,r,i,o,u,a,s;for(t=[],a=this.nodes,r=0,o=a.length;o>r;r++)for(n=a[r],s=n.inputs,i=0,u=s.length;u>i;i++)e=s[i],null===e.input&&t.push(e);return t},t.prototype.outputs=function(){var t,n,e,r,i,o,u,a,s;for(e=[],a=this.nodes,r=0,o=a.length;o>r;r++)for(t=a[r],s=t.outputs,i=0,u=s.length;u>i;i++)n=s[i],0===n.output.length&&e.push(n);return e},t.prototype.tail=function(){return this.nodes[this.nodes.length-1]},t.prototype.add=function(t,n){var e,r,i;{if(!t.length){if(t.graph&&!n)throw"Adding node to two graphs at once";return t.setGraph(this),this.nodes.push(t)}for(e=0,r=t.length;r>e;e++)i=t[e],this.add(i)}},t.prototype.remove=function(t,n){var e,r,i;{if(!t.length){if(t.graph!==this)throw"Removing node from wrong graph.";return n||t.disconnect(),this.nodes.splice(this.nodes.indexOf(t),1),t.setGraph(null)}for(e=0,r=t.length;r>e;e++)i=t[e],this.remove(i)}},t}(),n.exports=e},{}],3:[function(t,n,e){e.Graph=t("./graph"),e.Node=t("./node"),e.Outlet=t("./outlet")},{"./graph":2,"./node":4,"./outlet":5}],4:[function(t,n){var e,r,i;e=t("./graph"),i=t("./outlet"),r=function(){function t(t,n){this.owner=t,this.graph=null,this.inputs=[],this.outputs=[],this.outlets=null,this.setOutlets(n)}return t.prototype.getOwner=function(){return this.owner},t.prototype.setGraph=function(t){this.graph=t},t.prototype.getIn=function(t){var n;return function(){var e,r,i,o;for(i=this.inputs,o=[],e=0,r=i.length;r>e;e++)n=i[e],n.name===t&&o.push(n);return o}.call(this)[0]},t.prototype.getOut=function(t){var n;return function(){var e,r,i,o;for(i=this.outputs,o=[],e=0,r=i.length;r>e;e++)n=i[e],n.name===t&&o.push(n);return o}.call(this)[0]},t.prototype.get=function(t){return this.getIn(t)||this.getOut(t)},t.prototype.setOutlets=function(t){var n,e,r,o,u,a,s,c,l,f,h,p,d;if(o=function(t){return new i(t.inout,t.name,t.hint,t.type,t.meta)},null!=t){if(null==this.outlets){for(this.outlets={},s=0,f=t.length;f>s;s++)a=t[s],this._add(o(a));return this.first=!1}for(e=function(t){return[t.name,t.inout,t.type].join("-")},u={},c=0,h=t.length;h>c;c++)a=t[c],u[e(a)]=!0;d=this.outlets;for(r in d)a=d[r],r=e(a),u[r]?u[r]=a:this._remove(a);for(l=0,p=t.length;p>l;l++)a=t[l],n=u[e(a)],n instanceof i?this._morph(n,a):this._add(o(a))}return this.outlets},t.prototype.connect=function(t,n,e){var r,i,o,u,a,s,c,l,f,h,p,d;for(a={},i={},p=t.inputs,c=0,f=p.length;f>c;c++)u=p[c],(e||!u.input)&&(s=u.type,r=[s,u.hint].join("-"),i[r]||(i[r]=u),a[s]=a[s]||[],a[s].push(u));for(d=this.outputs,l=0,h=d.length;h>l;l++)u=d[l],n&&u.output.length||(s=u.type,r=[s,u.hint].join("-"),o=a[s],i[r]?(i[r].connect(u),delete i[r],o.splice(o.indexOf(u),1)):o&&o.length&&o.shift().connect(u));return this},t.prototype.disconnect=function(){var t,n,e,r,i,o,u;for(o=this.inputs,n=0,r=o.length;r>n;n++)t=o[n],t.disconnect();for(u=this.outputs,e=0,i=u.length;i>e;e++)t=u[e],t.disconnect();return this},t.prototype._key=function(t){return[t.name,t.inout].join("-")},t.prototype._add=function(t){var n;if(n=this._key(t),t.node)throw"Adding outlet to two nodes at once.";if(this.outlets[n])throw"Adding two identical outlets to same node. ("+n+")";return t.setNode(this),t.inout===e.IN&&this.inputs.push(t),t.inout===e.OUT&&this.outputs.push(t),this.outlets[n]=t},t.prototype._morph=function(t,n){var e;return e=this._key(n),delete this.outlets[e],t.morph(n),e=this._key(n),this.outlets[e]=n},t.prototype._remove=function(t){var n,r;if(r=this._key(t),n=t.inout,t.node!==this)throw"Removing outlet from wrong node.";return t.disconnect(),t.setNode(null),delete this.outlets[r],t.inout===e.IN&&this.inputs.splice(this.inputs.indexOf(t),1),t.inout===e.OUT&&this.outputs.splice(this.outputs.indexOf(t),1),this},t}(),n.exports=r},{"./graph":2,"./outlet":5}],5:[function(t,n){var e,r;e=t("./graph"),r=function(){function t(n,e,r,i,o){this.inout=n,this.name=e,this.hint=r,this.type=i,this.meta=null!=o?o:{},this.node=null,null==this.hint&&(this.hint=e),this.index=++t.ID,this.key=null,this.input=null,this.output=[]}return t.ID=0,t.prototype.id=function(){return["","sg",this.name,this.index].join("_")},t.prototype.morph=function(t){return this.inout=t.inout,this.name=t.name,this.type=t.type,this.meta=t.meta||{}},t.prototype.connect=function(t){if(this.inout===e.IN&&t.inout===e.OUT)return t.connect(this);if(this.inout!==e.OUT||t.inout!==e.IN)throw"Can only connect out to in.";if(t.input!==this)return t.disconnect(),t.input=this,this.output.push(t)},t.prototype.disconnect=function(t){var n,e,r,i;if(this.input&&this.input.disconnect(this),this.output.length){if(!t){for(i=this.output,e=0,r=i.length;r>e;e++)t=i[e],t.input=null;return this.output=[]}if(n=this.output.indexOf(t),n>=0)return this.output.splice(n,1),t.input=null}},t.prototype.setNode=function(t){this.node=t},t}(),n.exports=r},{"./graph":2}],6:[function(t,n){var e,r,i,o,u,a,s,c;e=t("./factory"),r=t("./library"),i=function(){function n(t){null==t&&(t={}),this.library=new r(t)}return n.prototype.shader=function(){return new e(this.library)},n.Graph=t("./graph"),n}(),n.exports=i,window.ShaderGraph=i,o="// Comment\nuniform float uf;\nuniform float ufv1[3];\nuniform vec2 uv2;\n// Comment\nuniform vec2 uv2v[3];\nuniform vec3 uv3;\nuniform vec3 uv3v[3];\nuniform vec4 uv4;\nuniform vec4 uv4v[3];\nuniform sampler2D ut;\nuniform sampler2D utv[3];\nvarying float vf;\nvarying float vfv1[3];\nvarying mat3 vm3;\nvarying mat3 vm3v[3];\nvarying mat4 vm4;\nvarying mat4 vm4v[3];\nattribute float af;\nattribute float afv1[3];\nattribute vec3 av3;\nattribute vec3 av3v[3];\nattribute mat4 am4;\nattribute mat4 am4v[3];\n\nvoid callback1(in vec4 v4in);\n\nvoid callback2(in vec3 v3in, out vec4 v4out);\n\nvoid callback3(in vec3 v3in, in vec4 v4in, out vec4 v4out);\n\nvoid snippetTest(\n  in vec3 v3in, in vec4 v4in, mat3 m3vin[3],\n  out vec4 v4out, out vec4 v4vout[3], out mat4 m4out, out mat4 m4vout[3],\n  inout vec3 v3inout) {\n    callback1(v4in);\n    callback2(v3in, v4out);\n    callback3(v3in, v4in, v4out);\n    gl_FragColor = vec4(v4in.xyz, 1.0);\n}",o="uniform vec3 color;\n\n#pragma external\nconst void callback(const in vec4 rgba);\n\n#pragma export\nvoid main() { gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0); };\n",o="uniform vec2 sampleStep;\n\nuniform float fadeOut;\nuniform float field;\nuniform float time;\n\nuniform sampler2D texture;\nvarying vec2 vUV;\n\nfloat randf(vec2 xy) {\n  return fract(sin(dot(xy, vec2(3.1380, 7.41)) * 13.414) * 1414.32);\n}\n\nconst float c = .9999875;\nconst float s = .005;\nconst mat2 roto1 = mat2(c, s, -s, c);\nconst mat2 roto2 = mat2(c, -s, s, c);\n\nconst float c2 = .9998;\nconst float s2 = .02;\nconst mat2 roto3 = mat2(c2, -s2, s2, c2);\n\nvec2 rotozoom(vec2 xy) {\n  float r = sqrt(dot(xy, xy));\n  xy *= (7.0 * r + sin(r)) * .125 / r;\n  xy *= roto1;\n\n  return xy;\n}\n\nvec2 planeproject(vec2 xy) {\n  float f = .0625 * (15.0 + 1.0 / (-xy.y + 1.5));\n  xy *= f;\n  xy *= roto2;\n\n  return xy;\n}\n\nvec2 ball(vec2 xy) {\n  float r = sqrt(dot(xy, xy));\n  xy *= (3.0 + 1.75 * tan(r * .5) / r) * .25;\n  xy *= roto3;\n\n  return xy;\n}\n\nvec2 swirl(vec2 xy) {\n  vec2 a = xy * 2.25 * 6.28;\n  xy += vec2(sin(a.y), sin(a.x)) * .01;\n\n  vec2 b = xy * 4.5 * 6.28;\n  xy += vec2(-sin(b.y), sin(b.x)) * .01;\n\n  vec2 c = xy * 9.0 * 6.28;\n  xy += vec2(-sin(c.y), -sin(c.x)) * .01;\n  return xy;\n}\n\nvec2 warp(vec2 xy, float q) {\n\n  float r = sqrt(dot(xy, xy));\n  float th = atan(xy.y, xy.x) * 6.0;\n  float f = .99 * (r + sin(r * r * q * .5 + time + sin(th) * 2.0) * .02) / r;\n\n  return xy * f;\n}\n\nvec2 tiles(vec2 xy) {\n\n  vec2 grid = floor(xy * 9.0);\n  float index = mod(grid.x + grid.y + (1.0 + grid.x) * grid.x * grid.y * 3.0, 4.0);\n\n  float d = .01;\n  if (index < .5) {\n    xy.x += d;\n  }\n  else if (index < 1.5) {\n    xy.x -= d;\n  }\n  else if (index < 2.5) {\n    xy.y += d;\n  }\n  else {\n    xy.y -= d;\n  }\n\n  return xy;\n}\n\nvec2 flower(vec2 xy) {\n  vec2 orig = xy;\n  float r = sqrt(dot(xy, xy));\n  float th = atan(xy.y, xy.x);\n\n  float th2 = th + sin(r * 64.0);\n  float r2 = r + sin(th * 64.0);\n\n  return mix(orig, vec2(cos(th2) * r2, sin(th2) * r2), .01);\n}\n\nvec2 rotate(vec2 xy, vec2 ref, float a) {\n  vec2 diff = xy - ref;\n  float c = cos(a);\n  float s = sin(a);\n  return ref + diff * mat2(c, -s, s, c);\n}\n\nvoid callback();\n\nvoid main() {\n  vec2 xy = (vUV * 2.0 - 1.0) * vec2(16.0/9.0, 1.0);\n  vec2 pos = xy;\n\n  callback();\n\n  if (field > 0.0) {\n\n    if (field < 1.0) {\n      xy = mix(xy, rotozoom(pos), clamp(field, 0.0, 1.0));\n    }\n    else if (field < 2.0) {\n      xy = rotozoom(pos);\n      xy = mix(xy, planeproject(pos), clamp(field - 1.0, 0.0, 1.0));\n    }\n    else if (field < 3.0) {\n      xy = planeproject(pos);\n      xy = mix(xy, ball(pos), clamp(field - 2.0, 0.0, 1.0));\n    }\n    else if (field < 4.0) {\n      xy = ball(pos);\n      xy = mix(xy, rotate(xy, pos, time), clamp(field - 3.0, 0.0, 1.0));\n    }\n    else if (field < 5.0) {\n      xy = ball(pos);\n      xy = rotate(xy, pos, time);\n      xy = mix(xy, rotate(swirl(pos), pos, time), clamp(field - 4.0, 0.0, 1.0) * .5);\n    }\n    else if (field < 6.0) {\n      xy = ball(pos);\n      xy = rotate(xy, pos, time);\n      xy = mix(xy, rotate(swirl(pos), pos, time), .5);\n      xy = mix(xy, mix(rotate(warp(pos * 1.131, 32.0) / 1.131, pos, -time * 1.711), rotate(warp(pos, 27.0), pos, time), .5), clamp(field - 5.0, 0.0, 1.0));\n    }\n    else if (field < 7.0) {\n      xy = mix(rotate(warp(pos * 1.131, 32.0) / 1.131, pos, -time * 1.711), rotate(warp(pos, 27.0), pos, time), .5);\n      xy = mix(xy, rotate(tiles(pos), pos, -time), clamp(field - 6.0, 0.0, 1.0));\n    }\n    else { //if (field < 8.0) {\n      xy = rotate(tiles(pos), pos, -time) * .995;\n      xy = mix(xy, flower(pos), clamp(field - 7.0, 0.0, 1.0));\n    }\n\n    xy += sampleStep * .2;\n  }\n\n  xy *= vec2(9.0/16.0, 1.0);\n\n  vec2 uv = fract(xy * .5 + .5);\n  vec4 sample = texture2D(texture, uv);\n\n  gl_FragColor = vec4(sample.xyz - vec3(fadeOut), 1.0);\n\n}\n",u="uniform vec2 sampleStep;\n\nuniform float fadeOut;\nuniform float field;\nuniform float time;\n\nuniform sampler2D texture;\nvarying vec2 vUV;\n\nfloat randf(vec2 xy) {\n  return fract(sin(dot(xy, vec2(3.1380, 7.41)) * 1.0 * 2.0 / 3.0 / 4.0 * 5.0) * 1414.32);\n}\n",window.code=o,c={test:o},s=new i(c),a=s.shader().snippet("test")},{"./factory":1,"./graph":3,"./library":7}],7:[function(t,n){var e,r;r=t("./snippet"),e=function(){function t(t){this.snippets=null!=t?t:{},this.objects={}}return t.prototype.fetch=function(t){if(null==this.snippets[t])throw"Unknown snippet `"+t+"`";return null==this.objects[t]&&(this.objects[t]=r.load(t,this.snippets[t])),this.objects[t].clone()},t}(),n.exports=e},{"./snippet":10}],8:[function(t,n){var e,r,i,o;o=t("./walk"),i=function(){var t;return t=+new Date,function(n){var e;return e=+new Date-t,console.log(n,e+" ms"),e}},r=function(t){var n,e,r,i,o,u,a,s,c,l,f,h,p,d,g;for(n={},e=function(t){return n[t.name]=!0},e(t.main),h=t.external,i=0,s=h.length;s>i;i++)r=h[i],e(r);for(p=t.internal,o=0,c=p.length;c>o;o++)r=p[o],e(r);for(d=t.varying,u=0,l=d.length;l>u;u++)r=d[u],e(r);for(g=t.uniform,a=0,f=g.length;f>a;a++)r=g[a],e(r);return n},e=function(t){var n,e,u,a,s,c,l,f,h,p,d,g,v,m,y,x,_,w,b,k,M,T,C,j,P,O,D,E;return e=t.ast,C=t.signatures,w=r(C),console.log("placeholders",w),E=[],a="",g="",M=/[0-9A-Za-z_{}]/,d="",u="",O=function(t){var n;return g=a[a.length-1],n=t[0],";\n"!==t||"\n"!==g?(a.length&&M.test(g)&&M.test(n)&&(a+=" "),a+=t):void 0},y=function(t){return w[t]?_(t):O(t)},_=function(t){return O(" "),c(),E.push(function(n){return n[t]}),O(" ")},c=function(){return a.length&&(E.push(a),a=""),E},k=function(t){var n,e,r,i,u;for(d+="..",u=t.children,e=r=0,i=u.length;i>r;e=++r)n=u[e],o(m,null,n,d);return d=d.substring(2)},T=function(t){return d+="..",o(m,null,t,d),d=d.substring(2)},P=function(t){return t.parent&&(u+="  ",O("{\n")),k(t),t.parent&&(u=u.substring(2),O(u+"}")),!1},j=function(t,n){return O("else"===n?n:u),k(t),O(";\n"),!1},l=function(t,n){var e,r,i,o,u;if("="===n){for(u=t.children,r=i=0,o=u.length;o>i;r=++i)e=u[r],T(e),0===r&&O(" = ");return!1}return!0},n=function(t){var n,e,r,i,o,u;for(n=t.children,i=n.length-1,r=o=0,u=n.length;u>o;r=++o)e=n[r],T(e),i>r&&O(", ");return!1},p=function(t,n){var e;return e=t.children,O(n),O("("),T(e[0]),O(") "),T(e[1]),e[2]&&T(e[2]),!1},s=function(t){var n,e,r,i,o,u,a;for(e=t.children,o=e.length-1,n=!1,i=u=0,a=e.length;a>u;i=++u)r=e[i],"stmtlist"===r.type?(n=!0,O(") "),T(r)):(i>1&&O(", "),T(r),0===i&&O("("));return n||O(")"),!1},x=function(t,n){var e,r,i,o,u,a;if(e=t.children,o=e.length,1===o)O(n),T(e[0]);else for("."!==n&&(n=" "+n+" "),i=u=0,a=e.length;a>u;i=++u)r=e[i],T(r),0===i&&O(n);return!1},h=function(t,n){return y(n),!0},v=function(t,n){return O(n),!0},f=function(t){return O("("),k(t),O(")"),!1},b=function(t){return O("["),k(t),O("]"),!1},m=function(t){var e,r;switch(r=t,e=t.token.data,t.type){case"placeholder":return!1;case"expr":return!0;case"decl":return!0;case"stmt":return j(r,e);case"literal":return v(r,e);case"keyword":return v(r,e);case"ident":return h(r,e);case"decllist":return l(r,e);case"builtin":return v(r,e);case"binary":return x(r,e);case"return":return v(r,e);case"call":return s(r,e);case"function":return s(r,e);case"functionargs":return n(r,e);case"if":return p(r,e);case"else":return elsestmt(r,e);case"group":return f(r,e);case"stmtlist":return P(r,e);case"quantifier":return b(r,e);case"preprocessor":return!1;default:switch(t.token.type){case"operator":return x(r,e);default:return!1}}},D=i(),o(m,null,e,""),E=c(),D("GLSL Compile"),function(t,n){var e,r,i,o,u,a,s;null==t&&(t=""),null==n&&(n={}),r={};for(e in w)r[e]=t+(null!=(s=n[e])?s:e);for(i="",u=0,a=E.length;a>u;u++)o=E[u],i+=o.call?o(r):o;return i}},n.exports=e},{"./walk":13}],9:[function(t,n){var e,r;n.exports=e={},e["in"]=0,e.out=1,e.inout=2,r=function(t){return t.token.data},e.copy=function(t){var n,e,r,i;return i=t,e=i.name,t=i.type,r=i.value,n=i.inout,{name:e,type:t,value:r,inout:n}},e.type=function(t,n,r,i){var o,u,a,s,c,l;return a={"float":"f",vec2:"v2",vec3:"v3",vec4:"v4",mat3:"m3",mat4:"m4",sampler2D:"t",samplerCube:"t"},o={"float":0,vec2:window.THREE?new THREE.Vector3:null,vec3:window.THREE?new THREE.Vector3:null,vec4:window.THREE?new THREE.Vector4:null,mat4:window.THREE?new THREE.Matrix4:null,sampler2D:0,samplerCube:0},u={"in":e["in"],out:e.out,inout:e.inout},s=a[n],r&&(s+="v"),c=o[s],i=null!=(l=u[i])?l:u["in"],{name:t,type:s,value:c,inout:i}},e.node=function(t){var n,r,i,o;return"keyword"!==(null!=(n=t.token)?n.type:void 0)||"attribute"!==(r=null!=(i=t.token)?i.data:void 0)&&"uniform"!==r&&"varying"!==r?"function"===(null!=(o=t.children[5])?o.type:void 0)?e["function"](t):void 0:e.external(t)},e.external=function(t){var n,e,i,o,u,a,s;return n=t.children,u=r(n[1]),a=r(n[3]),s=r(n[4]),i=n[5],e=r(i.children[0]),o=i.children[1],{decl:"external",storage:u,type:s,ident:e,quant:!!o}},e["function"]=function(t){var n,i,o,u,a,s,c,l,f,h;return o=t.children,l=r(o[1]),f=r(o[3]),h=r(o[4]),s=o[5],c=r(s.children[0]),n=s.children[1],i=s.children[2],a=function(){var t,r,i,o;for(i=n.children,o=[],t=0,r=i.length;r>t;t++)u=i[t],o.push(e.argument(u));return o}(),{decl:"function",storage:l,type:h,ident:c,body:!!i,args:a}},e.argument=function(t){var n,e,i,o,u,a,s;return n=t.children,a=r(n[1]),i=r(n[2]),s=r(n[4]),o=n[5],e=r(o.children[0]),u=o.children[1],{decl:"argument",storage:a,inout:i,type:s,ident:e,quant:!!u}}},{}],10:[function(t,n,e){e.Snippet=t("./snippet"),e.load=e.Snippet.load},{"./snippet":12}],11:[function(t,n){var e,r,i,o,u,a,s,c,l,f,h,p;h=t("../../vendor/glsl-tokenizer"),c=t("../../vendor/glsl-parser"),r=t("./decl"),p=t("./walk"),f=function(){var t;return t=+new Date,function(n){var e;return e=+new Date-t,console.log(n,e+" ms"),e}},a=function(t,n){var e,r;return e=s(t,n),r=l(e)},s=function(t,n){var e,r,i,o,u,a,s,l;if(o=f(),s=h().process(c(),n),l=s[0],e=l[0],i=s[1],o("GLSL Tokenize & Parse"),!e||i.length){for(u=0,a=i.length;a>u;u++)r=i[u],console.error("[ShaderGraph] "+t+" -",r.message);throw"GLSL parse error"}return e},l=function(t){var n,r,a,s,c,l,h;return l=f(),c=[],p(u,e(c),t,""),h=o(c),a=h[0],r=h[1],n=h[2],s=i(a,r,n),l("GLSL AST"),{ast:t,signatures:s}},e=function(t){return function(n){return n?t.push(n):void 0}},u=function(t,n){switch(t.type){case"decl":return n(r.node(t)),!1}return!0},o=function(t){var n,e,r,i,o,u,a,s;for(i=null,r=[],e=[],o={},a=0,s=t.length;s>a;a++)u=t[a],u.body?(o[u.ident]&&(e=function(){var t,r,i;for(i=[],t=0,r=e.length;r>t;t++)n=e[t],n.ident!==u.ident&&i.push(n);return i}(),delete o[u.ident]),r.push(u),i=u):(e.push(u),o[u.ident]=!0);return[i,r,e]},i=function(t,n,e){var i,o,u,a,s,c,l,f,h;for(a={uniform:[],attribute:[],varying:[],external:[],internal:[],main:null},o=function(t){return r.type(t.ident,t.type,t.quant,t.inout)},u=function(t,n){var e,i,u,a,s,c,l,f,h,p,d;for(f=function(){var n,e,r,u;for(r=t.args,u=[],n=0,e=r.length;e>n;n++)i=r[n],u.push(o(i));return u}(),p=0,d=f.length;d>p;p++)a=f[p],a.inout===r.inout&&(e=a,u=r.copy(a),e.inout=r["in"],u.inout=r.out,u.name+="__inout",f.push(u));return"void"!==t.type&&f.push(r.type("_return__",t.type,!1,"out")),c=function(){var t,n,e;for(e=[],t=0,n=f.length;n>t;t++)a=f[t],a.inout===r["in"]&&e.push(a.type);return e}().join(","),l=function(){var t,n,e;for(e=[],t=0,n=f.length;n>t;t++)a=f[t],a.inout===r.out&&e.push(a.type);return e}().join(","),h="("+c+")("+l+")",s={name:t.ident,type:h,signature:f,inout:n}},a.main=u(t,r.out),c=0,f=n.length;f>c;c++)s=n[c],a.internal.push({name:s.ident});for(l=0,h=e.length;h>l;l++)switch(s=e[l],s.decl){case"external":i=o(s),a[s.storage].push(i);break;case"function":i=u(s,r["in"]),a.external.push(i)}return a},n.exports=a},{"../../vendor/glsl-parser":14,"../../vendor/glsl-tokenizer":18,"./decl":9,"./walk":13}],12:[function(t,n){var e,r,i;i=t("./parse"),r=t("./compile"),e=function(){function t(t,n,e){this.signatures=t,this.assembler=n,this._program=e,this.namespace=null,this.program=null,this.uniforms=null,this.entry=null,this.main=null,this.externals=null}return t.id=0,t.namespace=function(){return"_sg_"+ ++t.id+"_"},t.load=function(n,e){var o,u;return u=i(n,e),o=r(u),new t(u.signatures,o,u)},t.prototype.clone=function(){return new t(this.signatures,this.assembler,this._program)},t.prototype.apply=function(n,e){var r,i,o,u,a,s,c,l,f,h,p,d,g,v;for(this.namespace=e,null==this.namespace&&(this.namespace=t.namespace()),this.program=this.assembler(this.namespace),this.uniforms={},this.attributes={},this.externals={},a=function(t){return function(n){return t.uniforms[t.namespace+n.name]=n}}(this),r=function(t){return function(n){return t.attributes[t.namespace+n.name]=n}}(this),o=function(t){return function(n){return t.externals[t.namespace+n.name]=n}}(this),u=function(t){return function(n){return t.main=n,t.entry=t.namespace+n.name}}(this),d=this.signatures.uniform,s=0,f=d.length;f>s;s++)i=d[s],a(i);for(g=this.signatures.attribute,c=0,h=g.length;h>c;c++)i=g[c],r(i);for(u(this.signatures.main),v=this.signatures.external,l=0,p=v.length;p>l;l++)i=v[l],o(i);throw"lol error"},t}(),n.exports=e},{"./compile":8,"./parse":11}],13:[function(t,n){var e,r;e=!1,r=function(t,n,i,o){var u,a,s,c,l,f,h,p,d;if(e&&console.log(o,i.type,null!=(f=i.token)?f.data:void 0,null!=(h=i.token)?h.type:void 0),s=t(i,n)){for(p=i.children,d=[],a=c=0,l=p.length;l>c;a=++c)u=p[a],d.push(r(t,n,u,o+"  ",e));return d}},n.exports=r},{}],14:[function(t,n){n.exports=t("./lib/index")},{"./lib/index":16}],15:[function(t,n){function e(){return this}function r(t,n){var e=m[t];return n=n||0,e?n>e.lbp&&(e.lbp=n):(e=Object.create(v),e.id=t,e.lbp=n,m[t]=e),e}function i(t){var n,e=p;for(l(),n=e.nud();t<p.lbp;)e=p,l(),n=e.led(n);return n}function o(t,n,e){var o=r(t,n);o.led=e||function(t){return this.children=[t,i(n)],this.type="binary",this}}function u(t,n,e){var o=r(t,n);return o.led=e||function(t){return this.children=[t,i(n-1)],this.type="binary",this},o}function a(t,n){var e=r(t);return e.nud=n||function(){return this.children=[i(70)],this.type="unary",this},e}function s(t){var n=r(t,150);n.led=function(t){return this.children=[t],this.type="suffix",this}}function c(t){return u(t,10,function(t){return this.children=[t,i(9)],this.assignment=!0,this.type="assign",this})}function l(t){var n,r,i,o;if(t&&p.data!==t)return h.unexpected("expected `"+t+"`, got `"+p.data+"`");if(g>=d.length)return void(p=m["(end)"]);if(n=d[g++],r=n.data,i=n.type,"ident"===i)o=h.scope.find(r)||h.create_node(),i=o.type;else if("builtin"===i)o=m["(builtin)"];else if("keyword"===i)o=m["(keyword)"];else if("operator"===i){if(o=m[r],!o)return h.unexpected("unknown operator `"+r+"`")}else{if("float"!==i&&"integer"!==i)return h.unexpected("unexpected token.");i="literal",o=m["(literal)"]}return o&&(o.nud||(o.nud=e),o.children||(o.children=[])),o=Object.create(o),o.token=n,o.type=i,o.data||(o.data=r),p=o}function f(t){return function(){return h.unexpected(t)}}var h,p,d,g,v={nud:function(){return this.children&&this.children.length?this:f("unexpected")()},led:f("missing operator")},m={};r("(ident)").nud=e,r("(keyword)").nud=e,r("(builtin)").nud=e,r("(literal)").nud=e,r("(end)"),r(":"),r(";"),r(","),r(")"),r("]"),r("}"),u("&&",30),u("||",30),o("|",43),o("^",44),o("&",45),o("==",46),o("!=",46),o("<",47),o("<=",47),o(">",47),o(">=",47),o(">>",48),o("<<",48),o("+",50),o("-",50),o("*",60),o("/",60),o("%",60),o("?",20,function(t){return this.children=[t,i(0),(l(":"),i(0))],this.type="ternary",this}),o(".",80,function(t){return p.type="literal",h.fake(p),this.children=[t,p],l(),this}),o("[",80,function(t){return this.children=[t,i(0)],this.type="binary",l("]"),this}),o("(",80,function(t){if(this.children=[t],this.type="call",")"!==p.data)for(;;){if(this.children.push(i(0)),","!==p.data)break;l(",")}return l(")"),this}),a("-"),a("+"),a("!"),a("~"),a("defined"),a("(",function(){return this.type="group",this.children=[i(0)],l(")"),this}),a("++"),a("--"),s("++"),s("--"),c("="),c("+="),c("-="),c("*="),c("/="),c("%="),c("&="),c("|="),c("^="),c(">>="),c("<<="),n.exports=function(t,n){function e(t){h.unshift(t,!1);for(var n=0,r=t.children.length;r>n;++n)e(t.children[n]);h.shift()}h=t,d=n,g=0;var r;if(d.length){if(l(),r=i(0),r.parent=h[0],e(r),g<d.length)throw new Error("did not use all tokens");r.parent.children=[r]}}},{}],16:[function(t,n){function e(){function t(t){if("whitespace"===t.type||"line-comment"===t.type||"block-comment"===t.type)return void Xn.push(t);for(Wn.push(t),Sn=Sn||Wn[0],Sn&&Xn.length&&(Sn.preceding=Sn.preceding||[],Sn.preceding=Sn.preceding.concat(Xn),Xn=[]);e();)switch(Kn[0].mode){case d:W();break;case g:U();break;case x:X();break;case _:Y();break;case M:en();break;case v:wn(!0,!0);break;case T:bn();break;case p:nn();break;case P:tn();break;case O:$();break;case m:On();break;case y:Dn();break;case w:Mn();break;case b:jn();break;case q:Pn();break;case D:Cn();break;case k:Tn();break;case I:kn()}}function n(n){return arguments.length&&t(n),Kn.length>1?void ln("unexpected EOF"):void Zn.emit("end")}function e(){return Yn||!Kn.length?!1:(Sn=Wn[0])&&!Zn.paused}function h(t){Kn.unshift(t),Kn.shift()}function C(t,n){t.parent=Kn[0];var e=[].unshift.call(this,t);if(n=void 0===n?!0:n,f){for(var r="",i=0,o=this.length-1;o>i;++i)r+=" |";console.log(r,"\\"+t.type,t.token.data)}return n&&Fn!==t&&Fn.children.push(t),Fn=t,e}function j(){var t=[].shift.call(this),n=Jn[this.length],e=!1;if(f){for(var r="",i=0,o=this.length;o>i;++i)r+=" |";console.log(r,"/"+t.type)}return Jn.length?"function"==typeof Jn[0]?e=Jn[0](t):void 0!==n&&(e=n.test?n.test(t.type):n===t.type):e=!0,e&&Zn.emit("data",t),Fn=t.parent,t}function U(){function t(){if(Sn.data===Kn[0].expecting)return Kn.scope.exit(),Kn.shift();switch(Sn.type){case"preprocessor":return Kn.fake(on()),void Wn.shift();default:return void Kn.unshift(Ln())}}return pn(function(){return Kn.scope.enter(),l},t)()}function W(){if(Kn[0].brace)return"}"!==Sn.data?ln("expected `}`, got "+Sn.data):(Kn[0].brace=!1,Wn.shift(),Kn.shift());switch(Sn.type){case"eof":return Kn.shift();case"keyword":switch(Sn.data){case"for":return Kn.unshift(Gn());case"if":return Kn.unshift(Nn());case"while":return Kn.unshift(Hn());case"do":return Kn.unshift(Bn());case"break":return Kn.fake(r(E,Sn)),Wn.shift();case"continue":return Kn.fake(r(S,Sn)),Wn.shift();case"discard":return Kn.fake(r(F,Sn)),Wn.shift();case"return":return Kn.unshift(An());case"precision":return Kn.unshift(Vn())}return Kn.unshift(un(A));case"ident":var t;if(t=Kn.scope.find(Sn.data))return Kn.unshift("struct"===t.parent.type?un(A):sn(";"));case"operator":if("{"===Sn.data){Kn[0].brace=!0;var n=qn();return n.expecting="}",Wn.shift(),Kn.unshift(n)}if(";"===Sn.data)return Wn.shift(),Kn.shift();default:return Kn.unshift(sn(";"))}}function X(){function t(){return"invariant"===Sn.data?d.flags&z?(Kn.unshift(cn()),l):ln("`invariant` is not allowed here"):(Kn.fake(r(L,{data:"",position:Sn.position})),l)}function n(){return i(Sn)?d.flags&G?(Kn.unshift(cn()),l):ln("storage is not allowed here"):(Kn.fake(r(L,{data:"",position:Sn.position})),l)}function e(){return o(Sn)?d.flags&N?ln("parameter is not allowed here"):(Kn.unshift(cn()),l):(Kn.fake(r(L,{data:"",position:Sn.position})),l)}function a(){return u(Sn)?(Kn.unshift(cn()),l):(Kn.fake(r(L,{data:"",position:Sn.position})),l)}function s(){if("struct"===Sn.data)return d.flags&H?(Kn.unshift(an()),l):ln("cannot nest structs");if("keyword"===Sn.type)return Kn.unshift(cn()),l;var t=Kn.scope.find(Sn.data);return t?(Kn.fake(Object.create(t)),Wn.shift(),l):ln("expected user defined type, struct or keyword, got "+Sn.data)}function c(){return","!==Sn.data||d.flags&R?"["===Sn.data?void Kn.unshift(Qn()):")"===Sn.data?Kn.shift():";"===Sn.data?d.stage+3:"ident"!==Sn.type?ln("expected identifier, got "+Sn.data):(d.collected_name=Wn.shift(),l):Kn.shift()}function f(){return"("===Sn.data?(Wn.unshift(d.collected_name),delete d.collected_name,Kn.unshift(Un()),d.stage+2):l}function h(){return Wn.unshift(d.collected_name),delete d.collected_name,Kn.unshift(In()),l}function p(){return Kn.shift()}var d=Kn[0];return pn(t,n,e,a,s,c,f,h,p)()}function Y(){if("ident"===Sn.type){var t=Sn.data;return Kn.unshift(Rn()),void Kn.scope.define(t)}if("operator"===Sn.type){if(","===Sn.data)return Kn[1].flags&R?Wn.shift():Kn.shift();if("="===Sn.data)return Kn[1].flags&V?(Wn.shift(),void Kn.unshift(sn(",",";"))):ln("`=` is not allowed here.");if("["===Sn.data)return void Kn.unshift(Qn())}return Kn.shift()}function $(){return"keyword"===Sn.type?(Kn[0].type="keyword",void(Kn[0].mode=P)):"ident"===Sn.type?(Kn[0].type="ident",void(Kn[0].mode=p)):ln("expected keyword or user-defined name, got "+Sn.data)}function tn(){return"keyword"!==Sn.type?ln("expected keyword, got "+Sn.data):(Kn.shift(),Wn.shift())}function nn(){return"ident"!==Sn.type?ln("expected user-defined name, got "+Sn.data):(Kn[0].data=Sn.data,Kn.shift(),Wn.shift())}function en(){function t(t){return s(Kn,t),Kn.shift()}var n=Kn[0].expecting;if(Kn[0].tokens=Kn[0].tokens||[],void 0===Kn[0].parenlevel&&(Kn[0].parenlevel=0,Kn[0].bracelevel=0),Kn[0].parenlevel<1&&n.indexOf(Sn.data)>-1)return t(Kn[0].tokens);switch("("===Sn.data?++Kn[0].parenlevel:")"===Sn.data&&--Kn[0].parenlevel,Sn.data){case"{":++Kn[0].bracelevel;break;case"}":--Kn[0].bracelevel;break;case"(":++Kn[0].parenlevel;break;case")":--Kn[0].parenlevel}return Kn[0].parenlevel<0?ln("unexpected `)`"):Kn[0].bracelevel<0?ln("unexpected `}`"):void Kn[0].tokens.push(Wn.shift())}function rn(t){return function(){return r(t,Sn)}}function on(){return r(K[Sn.type],Sn,Fn)}function un(t){var n=r(x,Sn,Fn);return n.flags=t,n}function an(t,n){var e=r(v,Sn,Fn);return e.allow_assign=void 0===t?!0:t,e.allow_comma=void 0===n?!0:n,e}function sn(){var t=r(M,Sn,Fn);return t.expecting=[].slice.call(arguments),t}function cn(t){var n=Sn;return t&&(n={type:"(implied)",data:"(default)",position:n.position}),r(P,n,Fn)}function ln(t){Yn=!0,Zn.emit("error",new Error((t||"unexpected "+Kn)+" at line "+Kn[0].token.line))}function fn(t,n){return hn(t,Sn.type)&&hn(n,Sn.data)}function hn(t,n){switch(typeof t){case"string":return n!==t&&ln("expected `"+t+"`, got "+n+"\n"+Sn.data),!Yn;case"object":return t&&-1===t.indexOf(n)&&ln("expected one of `"+t.join("`, `")+"`, got "+n),!Yn}return!0}function pn(){var t,n,e=[].slice.call(arguments);return function(){var r=Kn[0];return r.stage||(r.stage=0),(t=e[r.stage])?(n=t(),n===l?++r.stage:void(void 0!==n&&(r.stage=n))):ln("parser in undefined state!")}}function dn(t,n){return n=n||"operator",function(){if(fn(n,t)){var e=Wn.shift(),r=Kn[0].children,i=r[r.length-1];return i&&i.token&&e.preceding&&(i.token.succeeding=i.token.succeeding||[],i.token.succeeding=i.token.succeeding.concat(e.preceding)),l}}}function gn(t){return function(){return Kn.unshift(sn(t)),l}}function vn(t){return t?function(){var t=Sn.data;return fn("ident")&&(Kn.unshift(Rn()),Kn.scope.define(t),l)}:function(){if(fn("ident")){var t=Object.create(Kn.scope.find(Sn.data));return t.token=Sn,Wn.shift(),l}}}function mn(){return function(){var t=qn();return t.expecting="}",Kn.unshift(t),l}}function yn(t){return function(){var n=Kn[0].stage;return"{"!==Sn.data?(Kn.unshift(Ln()),n+t):(Wn.shift(),l)}}function xn(){return function(){return Kn.shift(),Kn.shift()}}function _n(){wn=pn(dn("struct","keyword"),function(){return"{"===Sn.data?(Kn.fake(r(p,{data:"",position:Sn.position,type:"ident"})),l):vn(!0)()},function(){return Kn.scope.enter(),l},dn("{"),function(){return"}"===Sn.data?(Kn.scope.exit(),Wn.shift(),Kn.shift()):";"===Sn.data?void Wn.shift():void Kn.unshift(un(Q))}),bn=pn(function(){return Wn.shift(),l},function(){return fn("keyword",["lowp","mediump","highp"])&&(Kn.unshift(cn()),l)},function(){return Kn.unshift(cn()),l},function(){return Kn.shift()
}),kn=pn(dn("["),gn("]"),dn("]"),function(){return Kn.shift()}),Mn=pn(dn("for","keyword"),dn("("),function(){var t;if("ident"===Sn.type){if((t=Kn.scope.find(Sn.data))||(t=Kn.create_node()),"struct"===t.parent.type)return Kn.unshift(un(A)),l}else if("builtin"===Sn.type||"keyword"===Sn.type)return Kn.unshift(un(A)),l;return gn(";")()},dn(";"),gn(";"),dn(";"),gn(")"),dn(")"),yn(3),mn(),dn("}"),xn()),Tn=pn(dn("if","keyword"),dn("("),gn(")"),dn(")"),yn(3),mn(),dn("}"),function(){return"else"===Sn.data?(Wn.shift(),Kn.unshift(Ln()),l):xn()()},xn()),Cn=pn(dn("return","keyword"),function(){return";"===Sn.data?l:(Kn.unshift(sn(";")),l)},function(){Wn.shift(),xn()()}),jn=pn(dn("while","keyword"),dn("("),gn(")"),dn(")"),yn(3),mn(),dn("}"),xn()),Pn=pn(dn("do","keyword"),yn(3),mn(),dn("}"),dn("while","keyword"),dn("("),gn(")"),dn(")"),xn()),On=pn(function(){for(var t=1,n=Kn.length;n>t;++t)if(Kn[t].mode===m)return ln("function definition is not allowed within another function");return l},function(){if(fn("ident")){var t=Sn.data,n=Kn.scope.find(t);return Kn.unshift(Rn()),Kn.scope.define(t),Kn.scope.enter(n?n.scope:null),l}},dn("("),function(){return Kn.unshift(zn()),l},dn(")"),function(){return";"===Sn.data?(Kn.scope.exit(),Kn.shift(),Kn.shift()):l},dn("{"),mn(),dn("}"),function(){return Kn.scope.exit(),l},function(){return Kn.shift(),Kn.shift(),Kn.shift()}),Dn=pn(function(){return"void"===Sn.data?(Kn.fake(cn()),Wn.shift(),l):")"===Sn.data?void Kn.shift():"struct"===Sn.data?(Kn.unshift(an(Z,J)),l):(Kn.unshift(un(B)),l)},function(){return","===Sn.data?(Wn.shift(),0):")"===Sn.data?void Kn.shift():void ln("expected one of `,` or `)`, got "+Sn.data)})}var wn,bn,kn,Mn,Tn,Cn,jn,Pn,On,Dn,En,Sn,Fn,qn=rn(g),Ln=rn(d),In=rn(_),Vn=rn(T),Rn=rn(p),Un=(rn(O),rn(m)),zn=rn(y),Gn=rn(w),Nn=rn(k),Hn=rn(b),An=rn(D),Bn=rn(q),Qn=rn(I),Zn=a(t,n),Jn=arguments.length?[].slice.call(arguments):[],Kn=[],Wn=[],Xn=[],Yn=!1;return Kn.shift=j,Kn.unshift=C,Kn.fake=h,Kn.unexpected=ln,Kn.scope=new c(Kn),Kn.create_node=function(){var t=r(p,Sn);return t.parent=Zn.program,t},_n(),Fn=qn(),Fn.expecting="(eof)",Fn.mode=g,Fn.token={type:"(program)",data:"(program)"},En=Fn,Zn.program=En,Zn.scope=function(t){return 1===arguments.length&&(Kn.scope=t),Kn.scope},Kn.unshift(Fn),Zn}function r(t,n){return{mode:t,token:n,children:[],type:W[t]}}function i(t){return"const"===t.data||"attribute"===t.data||"uniform"===t.data||"varying"===t.data}function o(t){return"in"===t.data||"inout"===t.data||"out"===t.data}function u(t){return"highp"===t.data||"mediump"===t.data||"lowp"===t.data}n.exports=e;var a=t("../../through"),s=t("./expr"),c=t("./scope"),l=new Object,f=!1,h=0,p=h++,d=h++,g=h++,v=h++,m=h++,y=h++,x=h++,_=h++,w=h++,b=h++,k=h++,M=h++,T=h++,C=h++,j=h++,P=h++,O=h++,D=h++,E=h++,S=h++,F=h++,q=h++,L=h++,I=h++,V=1,R=2,U=4,z=8,G=16,N=32,H=64,A=255,B=A&~(V|R|N|z|U),Q=A&~(V|z|G|H),Z=!1,J=!1,K={"block-comment":C,"line-comment":C,preprocessor:j},W=h=["ident","stmt","stmtlist","struct","function","functionargs","decl","decllist","forloop","whileloop","if","expr","precision","comment","preprocessor","keyword","keyword_or_ident","return","break","continue","discard","do-while","placeholder","quantifier"]},{"../../through":22,"./expr":15,"./scope":17}],17:[function(t,n){function e(t){return this.constructor!==e?new e(t):(this.state=t,this.scopes=[],void(this.current=null))}n.exports=e;var r=e,i=r.prototype;i.enter=function(t){this.scopes.push(this.current=this.state[0].scope=t||{})},i.exit=function(){this.scopes.pop(),this.current=this.scopes[this.scopes.length-1]},i.define=function(t){this.current[t]=this.state[0]},i.find=function(t){for(var n=this.scopes.length-1;n>-1;--n)if(this.scopes[n].hasOwnProperty(t))return this.scopes[n][t];return null}},{}],18:[function(t,n){function e(){function t(t){t.length&&I.queue({type:w[U],data:t,position:N,line:G})}function n(t){for(V=0,B+=t.toString(),L=B.length;F=B[V],L>V;)switch(U){case c:V=C();break;case l:V=T();break;case f:V=M();break;case h:V=j();break;case p:V=D();break;case _:V=O();break;case d:V=E();break;case s:V=S();break;case y:V=k();break;case a:V=b()}R+=V,B=B.slice(V)}function e(){z.length&&t(z.join("")),U=x,t("(eof)"),I.queue(null)}function b(){return z=z.length?[]:z,"/"===q&&"*"===F?(N=R+V-1,U=c,q=F,V+1):"/"===q&&"/"===F?(N=R+V-1,U=l,q=F,V+1):"#"===F?(U=f,N=R+V,V):/\s/.test(F)?(U=y,N=R+V,V):(H=/\d/.test(F),A=/[^\w_]/.test(F),N=R+V,U=H?p:A?h:s,V)}function k(){return"\n"===F&&++G,/[^\s]/g.test(F)?(t(z.join("")),U=a,V):(z.push(F),q=F,V+1)}function M(){return"\n"===F&&++G,"\n"===F&&"\\"!==q?(t(z.join("")),U=a,V):(z.push(F),q=F,V+1)}function T(){return M()}function C(){return"/"===F&&"*"===q?(z.push(F),t(z.join("")),U=a,V+1):("\n"===F&&++G,z.push(F),q=F,V+1)}function j(){if("."===q&&/\d/.test(F))return U=d,V;if("/"===q&&"*"===F)return U=c,V;if("/"===q&&"/"===F)return U=l,V;if("."===F&&z.length){for(;P(z););return U=d,V}if(";"===F){if(z.length)for(;P(z););return t(F),U=a,V+1}var n=2===z.length&&"="!==F;if(/[\w_\d\s]/.test(F)||n){for(;P(z););return U=a,V}return z.push(F),q=F,V+1}function P(n){for(var e,r=0,i=n.length;;){e=o.indexOf(n.slice(0,n.length+r).join(""));{if(-1!==e)return t(o[e]),N+=o[e].length,z=z.slice(o[e].length),z.length;if(r-=1,i-=1,0>i)return 0}}}function O(){return/[^a-fA-F0-9]/.test(F)?(t(z.join("")),U=a,V):(z.push(F),q=F,V+1)}function D(){return"."===F?(z.push(F),U=d,q=F,V+1):/[eE]/.test(F)?(z.push(F),U=d,q=F,V+1):"x"===F&&1===z.length&&"0"===z[0]?(U=_,z.push(F),q=F,V+1):/[^\d]/.test(F)?(t(z.join("")),U=a,V):(z.push(F),q=F,V+1)}function E(){return"f"===F&&(z.push(F),q=F,V+=1),/[eE]/.test(F)?(z.push(F),q=F,V+1):/[^\d]/.test(F)?(t(z.join("")),U=a,V):(z.push(F),q=F,V+1)}function S(){if(/[^\d\w_]/.test(F)){var n=z.join("");return U=i.indexOf(n)>-1?m:u.indexOf(n)>-1?v:g,t(z.join("")),U=a,V}return z.push(F),q=F,V+1}var F,q,L,I=r(n,e),V=0,R=0,U=a,z=[],G=1,N=0,H=!1,A=!1,B="";return I}n.exports=e;var r=t("../through"),i=t("./lib/literals"),o=t("./lib/operators"),u=t("./lib/builtins"),a=999,s=9999,c=0,l=1,f=2,h=3,p=4,d=5,g=6,v=7,m=8,y=9,x=10,_=11,w=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"../through":22,"./lib/builtins":19,"./lib/literals":20,"./lib/operators":21}],19:[function(t,n){n.exports=["gl_Position","gl_PointSize","gl_ClipVertex","gl_FragCoord","gl_FrontFacing","gl_FragColor","gl_FragData","gl_FragDepth","gl_Color","gl_SecondaryColor","gl_Normal","gl_Vertex","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_FogCoord","gl_MaxLights","gl_MaxClipPlanes","gl_MaxTextureUnits","gl_MaxTextureCoords","gl_MaxVertexAttribs","gl_MaxVertexUniformComponents","gl_MaxVaryingFloats","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformComponents","gl_MaxDrawBuffers","gl_ModelViewMatrix","gl_ProjectionMatrix","gl_ModelViewProjectionMatrix","gl_TextureMatrix","gl_NormalMatrix","gl_ModelViewMatrixInverse","gl_ProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverse","gl_TextureMatrixInverse","gl_ModelViewMatrixTranspose","gl_ProjectionMatrixTranspose","gl_ModelViewProjectionMatrixTranspose","gl_TextureMatrixTranspose","gl_ModelViewMatrixInverseTranspose","gl_ProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixInverseTranspose","gl_TextureMatrixInverseTranspose","gl_NormalScale","gl_DepthRangeParameters","gl_DepthRange","gl_ClipPlane","gl_PointParameters","gl_Point","gl_MaterialParameters","gl_FrontMaterial","gl_BackMaterial","gl_LightSourceParameters","gl_LightSource","gl_LightModelParameters","gl_LightModel","gl_LightModelProducts","gl_FrontLightModelProduct","gl_BackLightModelProduct","gl_LightProducts","gl_FrontLightProduct","gl_BackLightProduct","gl_FogParameters","gl_Fog","gl_TextureEnvColor","gl_EyePlaneS","gl_EyePlaneT","gl_EyePlaneR","gl_EyePlaneQ","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_ObjectPlaneR","gl_ObjectPlaneQ","gl_FrontColor","gl_BackColor","gl_FrontSecondaryColor","gl_BackSecondaryColor","gl_TexCoord","gl_FogFragCoord","gl_Color","gl_SecondaryColor","gl_TexCoord","gl_FogFragCoord","gl_PointCoord","radians","degrees","sin","cos","tan","asin","acos","atan","pow","exp","log","exp2","log2","sqrt","inversesqrt","abs","sign","floor","ceil","fract","mod","min","max","clamp","mix","step","smoothstep","length","distance","dot","cross","normalize","faceforward","reflect","refract","matrixCompMult","lessThan","lessThanEqual","greaterThan","greaterThanEqual","equal","notEqual","any","all","not","texture2D","texture2DProj","texture2DLod","texture2DProjLod","textureCube","textureCubeLod"]},{}],20:[function(t,n){n.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],21:[function(t,n){n.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],22:[function(t,n){var e;e=function(t,n){var e,r;return r=[],e=[],{output:r,parser:null,write:t,end:n,process:function(n,e){return this.parser=n,t(e),this.flush(),this.parser.flush()},flush:function(){return n(),[r,e]},queue:function(t){var n;return null!=t?null!=(n=this.parser)?n.write(t):void 0:void 0},emit:function(t,n){return"data"===t&&null==n.parent&&r.push(n),"error"===t?e.push(n):void 0}}},n.exports=e},{}]},{},[6]);